function t(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function e(t,e){return e.get?e.get.call(t):e.value}function i(i,a){return e(i,t(i,a,"get"))}function a(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n(t,e,i){a(t,e),e.set(t,i)}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function o(t,e){a(t,e),e.add(t)}var c=new WeakSet;function l(){const t=JSON.stringify(this.state.cartItems);localStorage.setItem("freshy%#%shopping%#%cart%#%items",t)}var d=new class{addItem(t){const e=this.state.cartItems.findIndex((e=>e.item===t.item));-1===e?this.state.cartItems.push(t):this.state.cartItems[e].quantity+=t.quantity,r(this,c,l).call(this)}removeItem(t){this.state.cartItems=this.state.cartItems.filter((e=>e.item!=t)),r(this,c,l).call(this)}async getCartItems(){const t=[];for(const e of this.state.cartItems){const i=this.cache[e.item]||await this.fetchItem(e.item);this.cache[e.item]=i;const{image:a,name:n,price:s,unit:r}=i;t.push({id:e.item,quantity:e.quantity,image:a,name:n,unit:r,price:Math.round(100*(s*e.quantity+Number.EPSILON))/100})}return t}async fetchItems(t){var e;this.state.query=null!==(e=t.query)&&void 0!==e?e:this.state.query,this.state.page=t.page||1;const i=await fetch(`http://localhost:3000/api/v1/items?search=${this.state.query}&limit=10&page=${this.state.page}`);return await i.json()}async fetchItem(t){const e=await fetch(`http://localhost:3000/api/v1/items/${t}`);return(await e.json()).data.item}constructor(){o(this,c),s(this,"state",{query:"",page:1}),s(this,"cache",{}),this.state.cartItems=JSON.parse(localStorage.getItem("freshy%#%shopping%#%cart%#%items"))||[]}};class h{constructor(){s(this,"qs",(t=>document.querySelector(t))),s(this,"qsa",(t=>document.querySelectorAll(t)))}}var p=new WeakMap,m=new WeakSet,u=new WeakSet,v=new WeakSet;function g(){i(this,p).addEventListener("click",(t=>{if(t.target.closest(".form--search__btn")){t.preventDefault();const e=this.qs(".form--search__input").value;return this.searchAndPaginationHandler(e)}if(t.target.closest("[data-page]")){if(t.target.closest(".pagination__direction--inactive")||t.target.closest(".pagination__arrow--inactive"))return;const e=parseInt(t.target.closest("[data-page]").dataset.page);return this.searchAndPaginationHandler(e)}const e=t.target.closest(".item");if(e&&(t.target.closest(".item__increase")&&r(this,u,_).call(this,e),t.target.closest(".item__decrease")&&r(this,v,C).call(this,e),t.target.closest(".item__cta"))){const t=e.dataset.id;let i=parseFloat(e.querySelector(".item__input").value);i=Math.round(100*(i+Number.EPSILON))/100,i=i<.25?.25:i,i=i>50?50:i,e.querySelector(".item__input").value=i,this.addToCartHandler({item:t,quantity:i})}})),i(this,p).addEventListener("keydown",(t=>{if("Enter"!=t.key)return;if(t.preventDefault(),document.activeElement.closest(".form--search")){const t=this.qs(".form--search__input").value;this.searchAndPaginationHandler(t)}if(document.activeElement.closest("[data-page]")){if(document.activeElement.closest(".pagination__direction--inactive")||document.activeElement.closest(".pagination__arrow--inactive"))return;const t=parseInt(document.activeElement.closest("[data-page]").dataset.page);return this.searchAndPaginationHandler(t)}const e=document.activeElement.closest(".item");if(e){const t=e.dataset.id;let i=parseFloat(e.querySelector(".item__input").value);i=Math.round(100*(i+Number.EPSILON))/100,i=i<.25?.25:i,i=i>50?50:i,e.querySelector(".item__input").value=i,this.addToCartHandler({item:t,quantity:i})}}))}function _(t){const e=parseFloat(t.querySelector(".item__input").value);let i;i=e<.25?.25:e%.25==0?e+.25:.25*(parseInt(e/.25)+1),t.querySelector(".item__input").value=i}function C(t){const e=parseFloat(t.querySelector(".item__input").value);let i;i=e<=.25?.25:e%.25==0?e-.25:.25*(parseInt(e/.25)-1),t.querySelector(".item__input").value=i}const f=new class extends h{bindSearchAndPagination(t){this.searchAndPaginationHandler=t}bindAddToCart(t){this.addToCartHandler=t}clear(){var t,e,i,a;null===(t=this.qs(".loading"))||void 0===t||t.remove(),null===(e=this.qs(".items"))||void 0===e||e.remove(),null===(i=this.qs(".pagination"))||void 0===i||i.remove(),null===(a=this.qs(".error"))||void 0===a||a.remove(),this.qs(".form--search__input").value=""}addLoading(){i(this,p).insertAdjacentHTML("beforeend",'<div class="loading">\n                    <div class="loading__dot"></div>\n                </div>')}clearLoading(){var t;null===(t=this.qs(".loading"))||void 0===t||t.remove()}renderItems(t){let e='<div class="items" role="list" aria-label="Items you can buy">';t.forEach((t=>{e+=`\n    <article class="item" data-id=${t._id.toString()} data-default-quantity=${t.defaultQuantity}>\n        <img class="item__img" src="http://localhost:3000/imgs/${t.image}" alt="" />\n            <div class="item__title">\n            <span class="item__title__text"> ${t.name} </span>\n        </div>\n        <div class="item__quantity">\n            <span class="item__quantity__text">Quantity</span>\n            <div class="item__quantity__modifier">\n                <img\n                class="item__decrease"\n                src="http://localhost:3000/icons/minus.svg"\n                alt="Decrease the quantity"\n                />\n                <input class="item__input" type="text" value="${t.defaultQuantity}" />\n                <img\n                class="item__increase"\n                src="http://localhost:3000/icons/add.svg"\n                alt="Increase the quantity"\n                />\n            </div>\n        </div>\n        <span class="item__price">${t.price}€ / ${t.unit}</span>\n        <span tabindex="0" class="item__cta">Add to cart</span>\n    </article>`})),e+="</div>",i(this,p).insertAdjacentHTML("beforeend",e)}renderPagination(t,e){let a=`<footer class="pagination">\n    <img\n        data-page=${1===t?1:t-1}\n        class="pagination__arrow ${1===t?"pagination__arrow--inactive":""}"\n        src="http://localhost:3000/icons/arrow.svg"\n        alt="Move to the previous page icon"\n    />\n    <span\n        data-page=${1===t?1:t-1}\n        ${1!=t?'tabindex="0"':""}\n        class="pagination__direction ${1===t?"pagination__direction--inactive":""}"\n        >&#8592; Previous</span\n    >`;for(let i=1;i<=e;i++)a+=`\n    <div data-page=${i} tabindex="0" class="pagination__page ${i===t?"pagination__page--active":""}">\n        <span class="pagination__text">${i}</span>\n    </div>\n    `;a+=`<span data-page=${t===e?e:t+1}\n    ${t!=e?'tabindex="0"':""}\n       class="pagination__direction ${t===e?"pagination__direction--inactive":""}">Next &#8594;</span>\n    <img\n        data-page=${t===e?e:t+1}\n        class="pagination__arrow ${t===e?"pagination__arrow--inactive":""}"\n        src="http://localhost:3000/icons/arrow.svg"\n        alt="Move to the next page icon"\n    />\n    </footer>`,i(this,p).insertAdjacentHTML("beforeend",a)}renderError(t){const e=`<div class="error">\n    <svg\n      class="error__icon"\n      viewBox="0 0 32 32"\n      fill="none"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <path\n        d="M15.4062 0.0437222C11.375 0.193724 7.58125 1.84997 4.7125 4.71247C2.13125 7.29997 0.55 10.5812 0.125 14.25C0.03125 15.0125 0.03125 16.9875 0.125 17.75C0.55 21.4187 2.13125 24.7 4.7125 27.2875C6.96875 29.5437 9.78125 31.05 12.8562 31.65C14.0375 31.8812 14.7125 31.9437 16 31.9437C18.7938 31.9437 21.1688 31.35 23.5938 30.0375C27.775 27.7812 30.7437 23.7625 31.65 19.1437C31.8813 17.9625 31.9438 17.2875 31.9438 16C31.9438 13.2062 31.35 10.8312 30.0375 8.40622C27.7875 4.24372 23.7938 1.28122 19.175 0.349974C18.0312 0.124973 16.5438 -2.67029e-05 15.4062 0.0437222ZM17.7063 3.09372C20.5438 3.46247 23.1313 4.74997 25.1875 6.81247C27.25 8.86872 28.5375 11.4562 28.9062 14.2937C29.025 15.2062 29.025 16.7937 28.9062 17.7062C28.5375 20.5437 27.25 23.1312 25.1875 25.1875C23.1313 27.25 20.5438 28.5375 17.7063 28.9062C16.7938 29.025 15.2063 29.025 14.2937 28.9062C11.4563 28.5375 8.86875 27.25 6.8125 25.1875C4.75 23.1312 3.4625 20.5437 3.09375 17.7062C2.975 16.7937 2.975 15.2062 3.09375 14.2937C3.3875 12.05 4.275 9.92497 5.7 8.04372C6.2 7.38747 7.3875 6.19997 8.04375 5.69997C9.9 4.29372 12.0375 3.39372 14.225 3.09997C15.0813 2.98122 16.8313 2.98122 17.7063 3.09372Z"\n        fill="#EA4C41"\n      />\n      <path\n        d="M15.3376 7.1187C14.6626 7.2937 14.1751 7.73745 14.0626 8.27495C14.0188 8.4937 14.0001 10.0937 14.0126 13.1937L14.0313 17.7812L14.1751 18.0625C14.4563 18.6312 15.1188 18.95 16.0001 18.95C16.7126 18.95 17.1751 18.7812 17.5751 18.375C17.8001 18.1375 17.8813 18.0062 17.9376 17.7437C17.9876 17.5 18.0001 16.1312 17.9876 12.8125L17.9688 8.2187L17.8063 7.93745C17.5938 7.5812 17.4876 7.48745 17.0626 7.27495C16.7751 7.1312 16.6313 7.09995 16.1251 7.08745C15.8001 7.07495 15.4438 7.08745 15.3376 7.1187Z"\n        fill="#EA4C41"\n      />\n      <path\n        d="M15.6812 21.0687C15.0688 21.1625 14.5438 21.5562 14.25 22.1375C14.0875 22.4625 14.0625 22.5875 14.0625 23C14.0625 23.4125 14.0875 23.5375 14.25 23.8625C14.4563 24.2688 14.725 24.5437 15.1438 24.7625C15.3625 24.8812 15.5063 24.9062 16 24.9062C16.4938 24.9062 16.6375 24.8812 16.8563 24.7625C17.275 24.5437 17.5438 24.2688 17.75 23.8625C17.9125 23.5375 17.9375 23.4125 17.9375 23C17.9375 22.5875 17.9125 22.4625 17.75 22.1375C17.3563 21.3563 16.5438 20.9312 15.6812 21.0687Z"\n        fill="#EA4C41"\n      />\n    </svg>\n    <div class="error__text">\n      ${t} <br />\n      Please try again :)\n    </div>\n  </div>`;i(this,p).insertAdjacentHTML("beforeend",e)}constructor(){super(),o(this,m),o(this,u),o(this,v),n(this,p,{writable:!0,value:this.qs(".main")}),r(this,m,g).call(this)}};var w=new WeakMap,y=new WeakMap,q=new WeakMap,b=new WeakMap,L=new WeakSet,I=new WeakSet,S=new WeakSet,E=new WeakSet,A=new WeakSet,M=new WeakSet,$=new WeakSet,x=new WeakSet;function k(){let t;window.addEventListener("resize",(()=>{t=r(this,I,T).call(this,t),r(this,E,P).call(this)})),i(this,w).addEventListener("click",(()=>r(this,S,W).call(this))),i(this,y).addEventListener("click",(()=>r(this,S,W).call(this))),i(this,w).addEventListener("keydown",(t=>{"Enter"===t.key&&r(this,S,W).call(this)})),i(this,q).addEventListener("click",(t=>{if(t.target.closest(".shopping-cart__remove")){const e=t.target.closest("[data-id]").dataset.id;this.removeFromCartHandler(e)}t.target.closest(".shopping-cart__cta")&&r(this,M,F).call(this)})),i(this,q).addEventListener("keydown",(t=>{if("Enter"==t.key){if(t.preventDefault(),document.activeElement.closest("#hide-cart")&&r(this,S,W).call(this),document.activeElement.closest("[data-id]")){const t=document.activeElement.closest("[data-id]").dataset.id;this.removeFromCartHandler(t)}document.activeElement.closest(".shopping-cart__cta")&&r(this,M,F).call(this)}}))}function T(t){return document.body.classList.add("resize-animation-stopper"),clearTimeout(t),t=setTimeout((()=>{document.body.classList.remove("resize-animation-stopper")}),400)}function W(){cart.classList.toggle("shopping-cart--hidden"),this.qs(".shopping-cart--hidden")?i(this,w).focus():i(this,y).focus(),this.qsa("#cart [tabindex]").forEach((t=>{t.tabIndex=t.tabIndex<0?"0":"-1"}))}function P(){window.innerWidth>=1150?this.qsa("#cart [tabindex]").forEach((t=>{t.tabIndex="0"})):this.qsa("#cart [tabindex]").forEach((t=>{t.tabIndex="-1"}))}function H(){this.qsa("#cart [tabindex]").forEach((t=>{t.tabIndex=window.innerWidth>=1150?"0":"-1"}))}function F(){if(i(this,b).querySelectorAll("[data-id]").length)return location.assign("order");this.qs(".shopping-cart__cta").classList.add("no-items-animation"),setTimeout((()=>this.qs(".shopping-cart__cta").classList.remove("no-items-animation")),200)}function j(t){const e=window.innerWidth>=1150?"0":i(this,q).classList.contains("shopping-cart--hidden")?"-1":"0";return`\n    <article class="shopping-cart__item" data-id=${t.id}>\n      <img class="shopping-cart__img" src="http://localhost:3000/imgs/${t.image}" alt="" />\n      <div class="shopping-cart__info">\n        <div class="shopping-cart__info__header">\n          <span class="shopping-cart__info__title"\n            >${t.name}</span\n          >\n          <svg\n            tabindex="${e}"\n            class="shopping-cart__remove"\n            width="16"\n            height="16"\n            viewBox="0 0 16 16"\n            fill="none"\n            xmlns="http://www.w3.org/2000/svg"\n          >\n            <g clip-path="url(#clip0_28_5543)">\n              <path\n                class="shopping-cart__remove__x"\n                d="M0.712632 1.59712C0.579963 1.92879 0.557852 2.39313 0.662882 2.74139C0.723689 2.96803 1.03878 3.31629 3.24993 5.57166L5.76511 8.14212L3.24992 10.7126C0.497045 13.5207 0.574435 13.4212 0.596546 14.1067C0.618657 14.969 1.31517 15.6655 2.17752 15.6877C2.86297 15.7098 2.76347 15.7872 5.57163 13.0343L8.14209 10.5191L10.7126 13.0343C13.5207 15.7872 13.4212 15.7098 14.1067 15.6877C14.969 15.6655 15.6655 14.969 15.6876 14.1067C15.7097 13.4212 15.7871 13.5207 13.0343 10.7126L10.5191 8.14212L13.0343 5.57166C15.7871 2.7635 15.7097 2.863 15.6876 2.17754C15.6655 1.31519 14.969 0.618682 14.1067 0.596571C13.4212 0.57446 13.5207 0.497071 10.7126 3.24995L8.14209 5.76513L5.57163 3.24995C2.76347 0.497072 2.86297 0.574461 2.17752 0.596572C1.54734 0.607628 0.939276 1.02775 0.712632 1.59712Z"\n                fill="#001714"\n                fill-opacity="0.4"\n              />\n            </g>\n            <defs>\n              <clipPath id="clip0_28_5543">\n                <rect width="16" height="16" fill="white" />\n              </clipPath>\n            </defs>\n          </svg>\n        </div>\n        <div class="shopping-cart__info__body">\n          <span class="shopping-cart__info__quantity">${t.quantity} ${t.unit}</span>\n          <span class="shopping-cart__info__price">${t.price}€</span>\n        </div>\n      </div>\n    </article>`}function N(t){const e=`<div class="error">\n      <svg\n        class="error__icon"\n        viewBox="0 0 32 32"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M15.4062 0.0437222C11.375 0.193724 7.58125 1.84997 4.7125 4.71247C2.13125 7.29997 0.55 10.5812 0.125 14.25C0.03125 15.0125 0.03125 16.9875 0.125 17.75C0.55 21.4187 2.13125 24.7 4.7125 27.2875C6.96875 29.5437 9.78125 31.05 12.8562 31.65C14.0375 31.8812 14.7125 31.9437 16 31.9437C18.7938 31.9437 21.1688 31.35 23.5938 30.0375C27.775 27.7812 30.7437 23.7625 31.65 19.1437C31.8813 17.9625 31.9438 17.2875 31.9438 16C31.9438 13.2062 31.35 10.8312 30.0375 8.40622C27.7875 4.24372 23.7938 1.28122 19.175 0.349974C18.0312 0.124973 16.5438 -2.67029e-05 15.4062 0.0437222ZM17.7063 3.09372C20.5438 3.46247 23.1313 4.74997 25.1875 6.81247C27.25 8.86872 28.5375 11.4562 28.9062 14.2937C29.025 15.2062 29.025 16.7937 28.9062 17.7062C28.5375 20.5437 27.25 23.1312 25.1875 25.1875C23.1313 27.25 20.5438 28.5375 17.7063 28.9062C16.7938 29.025 15.2063 29.025 14.2937 28.9062C11.4563 28.5375 8.86875 27.25 6.8125 25.1875C4.75 23.1312 3.4625 20.5437 3.09375 17.7062C2.975 16.7937 2.975 15.2062 3.09375 14.2937C3.3875 12.05 4.275 9.92497 5.7 8.04372C6.2 7.38747 7.3875 6.19997 8.04375 5.69997C9.9 4.29372 12.0375 3.39372 14.225 3.09997C15.0813 2.98122 16.8313 2.98122 17.7063 3.09372Z"\n          fill="#EA4C41"\n        />\n        <path\n          d="M15.3376 7.1187C14.6626 7.2937 14.1751 7.73745 14.0626 8.27495C14.0188 8.4937 14.0001 10.0937 14.0126 13.1937L14.0313 17.7812L14.1751 18.0625C14.4563 18.6312 15.1188 18.95 16.0001 18.95C16.7126 18.95 17.1751 18.7812 17.5751 18.375C17.8001 18.1375 17.8813 18.0062 17.9376 17.7437C17.9876 17.5 18.0001 16.1312 17.9876 12.8125L17.9688 8.2187L17.8063 7.93745C17.5938 7.5812 17.4876 7.48745 17.0626 7.27495C16.7751 7.1312 16.6313 7.09995 16.1251 7.08745C15.8001 7.07495 15.4438 7.08745 15.3376 7.1187Z"\n          fill="#EA4C41"\n        />\n        <path\n          d="M15.6812 21.0687C15.0688 21.1625 14.5438 21.5562 14.25 22.1375C14.0875 22.4625 14.0625 22.5875 14.0625 23C14.0625 23.4125 14.0875 23.5375 14.25 23.8625C14.4563 24.2688 14.725 24.5437 15.1438 24.7625C15.3625 24.8812 15.5063 24.9062 16 24.9062C16.4938 24.9062 16.6375 24.8812 16.8563 24.7625C17.275 24.5437 17.5438 24.2688 17.75 23.8625C17.9125 23.5375 17.9375 23.4125 17.9375 23C17.9375 22.5875 17.9125 22.4625 17.75 22.1375C17.3563 21.3563 16.5438 20.9312 15.6812 21.0687Z"\n          fill="#EA4C41"\n        />\n      </svg>\n      <div class="error__text">${t}</div>\n    </div>`;i(this,b).insertAdjacentHTML("beforeend",e)}const Z=new class extends h{bindRemoveFromCart(t){this.removeFromCartHandler=t}renderItems(t){var e;if(0===t.length)return r(this,x,N).call(this,"Your shopping cart is empty");null===(e=i(this,q).querySelector(".error"))||void 0===e||e.remove(),t.forEach((t=>{const e=i(this,q).querySelector(`[data-id="${t.id}"`);if(!e){const e=r(this,$,j).call(this,t);return i(this,b).insertAdjacentHTML("beforeend",e)}e.querySelector(".shopping-cart__info__quantity").innerHTML=`${t.quantity} ${t.unit}`,e.querySelector(".shopping-cart__info__price").innerHTML=`${t.price}€`}))}animateCartBtn(){i(this,w).classList.add("item-added-animation"),setTimeout((()=>i(this,w).classList.remove("item-added-animation")),100)}updateCounter(){const t=i(this,b).querySelectorAll("[data-id]").length||0;i(this,w).dataset.items=t}removeItem(t){i(this,q).querySelector(`[data-id="${t}"`).remove(),0===i(this,b).querySelectorAll("[data-id]").length&&r(this,x,N).call(this,"Your shopping cart is empty")}constructor(){super(),o(this,L),o(this,I),o(this,S),o(this,E),o(this,A),o(this,M),o(this,$),o(this,x),n(this,w,{writable:!0,value:this.qs("#show-cart")}),n(this,y,{writable:!0,value:this.qs("#hide-cart")}),n(this,q,{writable:!0,value:this.qs("#cart")}),n(this,b,{writable:!0,value:this.qs(".shopping-cart__items")}),r(this,L,k).call(this),r(this,A,H).call(this)}};var O=new WeakMap;new class{constructor(){n(this,O,{writable:!0,value:async()=>{await this.handleSearchAndPagination("");const t=await this.model.getCartItems();this.viewAside.renderItems(t),this.viewAside.updateCounter()}}),s(this,"handleRemoveFromCart",(t=>{this.model.removeItem(t),this.viewAside.removeItem(t),this.viewAside.updateCounter()})),s(this,"handleAddToCart",(async t=>{this.model.addItem(t);const e=await this.model.getCartItems();this.viewAside.renderItems(e),this.viewAside.updateCounter(),this.viewAside.animateCartBtn()})),s(this,"handleSearchAndPagination",(async t=>{this.viewMain.clear(),this.viewMain.addLoading();const e=await this.model.fetchItems({page:"number"==typeof t?t:null,query:"string"==typeof t?t:null});return this.viewMain.clearLoading(),0===e.data.items.length?this.viewMain.renderError("No items found for your query."):"success"!=e.status?this.viewMain.renderError(e.message):(this.viewMain.renderItems(e.data.items),void this.viewMain.renderPagination(e.page,e.pages))})),this.model=d,this.viewMain=f,this.viewAside=Z,this.viewMain.bindSearchAndPagination(this.handleSearchAndPagination),this.viewMain.bindAddToCart(this.handleAddToCart),this.viewAside.bindRemoveFromCart(this.handleRemoveFromCart),i(this,O).call(this)}};